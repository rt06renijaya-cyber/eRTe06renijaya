<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portal Warga RT. 06 Reni Jaya</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* ============================
           GLOBAL STYLING & DASHBOARD
           ============================= */
        body {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f8fafc;
            color: #333;
            line-height: 1.6;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 20px;
            text-align: center;
        }
        
        /* HEADER ELEGAN & VISUAL */
        .header-elegant {
            background: linear-gradient(135deg, #003636, #005c5c); 
            color: white;
            padding: 90px 20px;
            border-bottom-left-radius: 60px;
            border-bottom-right-radius: 60px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.4);
            animation: fadeIn 1.2s ease-out;
        }
        /* Elemen dekoratif (Pola) */
        .header-elegant::before {
            content: "";
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="p" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 0 0 L 10 10 M 10 0 L 0 10" stroke="rgba(255,255,255,0.08)" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23p)"/></svg>') repeat;
            opacity: 0.2;
            z-index: 1;
        }

        .header-content {
            position: relative;
            z-index: 3;
            text-align: center;
            animation: slideUp 1.2s ease-out;
        }

        .logo-elegant {
            width: 130px;
            height: 130px;
            object-fit: contain;
            border-radius: 50%;
            border: 5px solid #ffffff;
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
            margin-bottom: 25px;
            background-color: #ffffff;
            animation: softFloat 4s ease-in-out infinite;
        }

        .title-elegant {
            font-size: 3em;
            font-weight: 700;
            margin: 0;
            letter-spacing: 2px;
            text-transform: uppercase;
            animation: fadeIn 1.6s ease-out;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .slogan-elegant {
            margin-top: 15px;
            font-size: 1.1em;
            opacity: 0.85;
            font-weight: 300;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
            animation: fadeIn 2s ease-out;
        }

        /* Animations */
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        @keyframes softFloat { 0% { transform: translateY(0); } 50% { transform: translateY(-8px); } 100% { transform: translateY(0); } }

        /* SECTION STYLING */
        h2 {
            font-size: 2.2em;
            font-weight: 700;
            color: #004d40;
            margin-bottom: 10px;
            margin-top: 40px;
        }
        
        .divider {
            width: 80px;
            height: 4px;
            background-color: #007bff;
            margin: 0 auto 40px auto;
            border-radius: 2px;
        }

        /* FEATURE CARDS MODERN */
        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            padding: 20px 0;
        }

        .feature-card {
            background-color: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.4s ease, box-shadow 0.4s ease;
            text-align: center;
            border-top: 5px solid transparent;
        }

        .feature-card:nth-child(1) { border-top-color: #28a745; }
        .feature-card:nth-child(2) { border-top-color: #ffc107; }
        .feature-card:nth-child(3) { border-top-color: #17a2b8; }
        .feature-card:nth-child(4) { border-top-color: #28a745; }
        .feature-card:nth-child(5) { border-top-color: #ffc107; }
        .feature-card:nth-child(6) { border-top-color: #17a2b8; }


        .feature-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
        }

        .feature-card i {
            font-size: 3em;
            color: #004d40;
            margin-bottom: 15px;
            transition: color 0.3s;
        }
        
        .feature-card:hover i {
             color: #007bff;
        }

        .feature-card h3 {
            color: #004d40;
            margin-top: 0;
            font-size: 1.4em;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .feature-card p {
            font-size: 0.95em;
            color: #6c757d;
        }

        .btn-primary {
            display: inline-block;
            color: white;
            padding: 12px 30px;
            text-decoration: none;
            border-radius: 50px;
            margin-top: 20px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            transition: all 0.3s;
        }

        /* Warna Tombol Disesuaikan */
        .btn-green { background-color: #28a745; }
        .btn-green:hover { background-color: #1e7e34; box-shadow: 0 6px 15px rgba(40, 167, 69, 0.4); }

        .btn-yellow { background-color: #ffc107; color: #333; }
        .btn-yellow:hover { background-color: #e0a800; box-shadow: 0 6px 15px rgba(255, 193, 7, 0.4); }

        .btn-teal { background-color: #17a2b8; }
        .btn-teal:hover { background-color: #117a8b; box-shadow: 0 6px 15px rgba(23, 162, 184, 0.4); }

        /* ABOUT SECTION */
        .about-section {
            padding: 40px 0;
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            margin-bottom: 40px;
        }
        
        .about-section p {
            max-width: 800px;
            margin: 15px auto 0 auto;
            font-size: 1.1em;
            color: #555;
        }

        /* FOOTER */
        .footer {
            background: linear-gradient(135deg, #002e28, #004d40);
            color: #e0ffff;
            text-align: center;
            padding: 40px 15px;
            border-top-left-radius: 30px;
            border-top-right-radius: 30px;
            box-shadow: 0 -5px 15px rgba(0,0,0,0.2);
        }
        
        .footer p {
            margin: 5px 0;
            font-size: 0.9em;
            opacity: 0.9;
        }
        
        .footer a {
            color: #ffc107;
            text-decoration: none;
            transition: color 0.3s;
        }
        .footer a:hover {
            color: #fff;
        }

        /* Responsive */
        @media(max-width: 768px) {
            .header-elegant {
                padding: 60px 15px;
                border-bottom-left-radius: 30px;
                border-bottom-right-radius: 30px;
            }
            .title-elegant { font-size: 2.2em; }
            .slogan-elegant { font-size: 1em; }
            .logo-elegant { width: 100px; height: 100px; }
            h2 { font-size: 1.8em; }
        }
        
        @media(max-width: 480px) {
             .title-elegant { font-size: 1.8em; letter-spacing: 1px; }
        }

        /* ============================
           POP-UP / MODAL STYLING
           ============================= */
        .modal-info {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.8); 
            display: none; 
            justify-content: center; align-items: center;
            z-index: 1000;
        }
        .modal-info.show { display: flex; }
        
        .modal-content {
            background: linear-gradient(135deg, #f0fdf4, #ccfbf1);
            padding: 30px; border-radius: 15px;
            max-width: 90%; width: 450px; text-align: left;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.4); 
            transform: scale(0.9); opacity: 0;
            transition: transform 0.3s ease-out, opacity 0.3s ease-out;
            border: 4px solid #065f46;
        }
        
        .modal-info.show .modal-content { transform: scale(1); opacity: 1; }

        .modal-header {
            border-bottom: 2px solid #065f46;
            padding-bottom: 15px; margin-bottom: 20px;
        }

        .modal-header h3 {
            margin: 0; color: #065f46; font-size: 1.8em;
            display: flex; align-items: center;
        }
        .modal-header i { margin-right: 10px; font-size: 1.2em; }
        
        .modal-body p { margin-bottom: 10px; color: #1f2937; }
        .modal-body strong { color: #065f46; }
        .modal-body .announcement-title { font-size: 1.4em; font-weight: 700; color: #007bff; margin-top: 0; margin-bottom: 15px;}
        .modal-body .announcement-content {
            background-color: #ffffff;
            padding: 15px; border-radius: 8px;
            border: 1px solid #e5e7eb;
            white-space: pre-wrap;
        }

        .modal-footer {
            margin-top: 25px; text-align: center;
        }
        
        .btn-close-modal {
            background-color: #007bff; color: white; padding: 10px 20px;
            border: none; border-radius: 50px; cursor: pointer;
            font-weight: 600; transition: background-color 0.3s, transform 0.1s;
        }
        .btn-close-modal:hover { background-color: #0056b3; transform: translateY(-2px); }
    </style>
</head>

<body>

    <div class="header-elegant">
        <div class="header-content">
            <img src="logo_rt06.png" alt="Logo RT 06" class="logo-elegant"> 

            <h1 class="title-elegant">Portal Warga RT. 06</h1>
            <p class="slogan-elegant">
                Bersama Mewujudkan Lingkungan Asri, Aman, dan Harmonis di Reni Jaya.
            </p>
        </div>
    </div>

    <div class="container">
        
        <h2>Layanan Digital Warga</h2>
        <div class="divider"></div>

        <div class="features">

            <div class="feature-card">
                <i class="fas fa-bullhorn"></i>
                <h3>Informasi Terbaru</h3>
                <p>Akses cepat pengumuman, jadwal kegiatan, dan berita penting dari Pengurus RT. 06.</p>
                <a href="informasi.html" class="btn-primary btn-green" target="_blank">
                    <i class="fas fa-search"></i> Lihat Pengumuman
                </a>
            </div>

            <div class="feature-card">
                <i class="fas fa-file-alt"></i>
                <h3>Layanan Administratif</h3>
                <p>Ajukan permohonan surat pengantar, izin keramaian, dan administrasi lainnya secara daring.</p>
                <a href="layanan.html" class="btn-primary btn-yellow" target="_blank">
                    <i class="fas fa-edit"></i> Ajukan Permohonan
                </a>
            </div>

            <div class="feature-card">
                <i class="fas fa-hand-holding-usd"></i>
                <h3>Transparansi Keuangan</h3>
                <p>Cek laporan iuran kas RT, catatan pemasukan/pengeluaran, dan anggaran kegiatan.</p>
                <a href="dashboard_keuangan.html" class="btn-primary btn-teal" target="_blank">
                    <i class="fas fa-chart-line"></i> Cek Keuangan
                </a>
            </div>
            
            <div class="feature-card">
                <i class="fas fa-exclamation-triangle"></i>
                <h3>Laporan Masalah</h3>
                <p>Laporkan isu keamanan, kebersihan, atau gangguan lingkungan dengan cepat dan mudah.</p>
                <a href="form-laporan-masalah.html" class="btn-primary btn-green" target="_blank">
                    <i class="fas fa-paper-plane"></i> Kirim Laporan
                </a>
            </div>
            
             <div class="feature-card">
                <i class="fas fa-map-marked-alt"></i>
                <h3>Peta & Denah</h3>
                <p>Informasi denah perumahan, lokasi fasilitas umum, dan batas wilayah RT. 06.</p>
                <a href="peta.html" class="btn-primary btn-yellow" target="_blank">
                    <i class="fas fa-location-arrow"></i> Lihat Peta
                </a>
            </div>
            
             <div class="feature-card">
                <i class="fas fa-sitemap"></i>
                <h3>Tentang RT. 06</h3>
                <p>Lihat struktur organisasi, visi & misi, serta profil pengurus RT. 06 Reni Jaya.</p>
                <a href="tentang-rt06.html" class="btn-primary btn-teal" target="_blank">
                    <i class="fas fa-info-circle"></i> Selengkapnya
                </a>
            </div>
            

        </div>
        
        <div class="about-section">
            <h2>Tentang RT. 06 Reni Jaya</h2>
            <div class="divider"></div>
            <p>Kami hadir sebagai platform digital untuk mempermudah komunikasi, transparansi, dan kolaborasi antara Pengurus RT dan seluruh warga. Dengan dukungan teknologi, kami berkomitmen untuk menciptakan lingkungan tempat tinggal yang lebih nyaman, aman, dan partisipatif bagi setiap keluarga di Reni Jaya. Silakan jelajahi berbagai layanan yang kami sediakan.</p>
        </div>
    </div>

    <div class="footer">
        <p>Portal Warga RT. 06 Reni Jaya</p>
        <p>&copy; 2025 Hak Cipta Dilindungi.<br>Dikelola oleh Pengurus RT. 06 | <a href="#">Kebijakan Privasi</a></p>
    </div>

    <div id="infoModal" class="modal-info">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-bullhorn"></i> PENGUMUMAN TERBARU</h3>
            </div>
            <div class="modal-body">
                <p class="announcement-title" id="modalJudul"></p>
                <p><strong>Tanggal Kegiatan:</strong> <span id="modalTanggal"></span></p>
                <p><strong>Kategori:</strong> <span id="modalKategori"></span></p>
                <p><strong>Penanggung Jawab:</strong> <span id="modalPenanggungJawab"></span></p>
                <div class="announcement-content" id="modalKonten"></div>
                <p style="margin-top: 15px; font-size: 0.85em; color: #6b7280;">Dipublikasikan pada: <span id="modalTimestamp"></span></p>
            </div>
            <div class="modal-footer">
                <button class="btn-close-modal" onclick="closeInfoModal()">
                    <i class="fas fa-check"></i> Mengerti, Tutup
                </button>
            </div>
        </div>
    </div>

    <script>
        // =========================================================================
        // WAJIB GANTI INI DENGAN URL DEPLOY APPS SCRIPT ANDA
        // =========================================================================
        const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyHo1ZoAE9XWyy7XHAPVahAO_HugbWtcZdw86BtCktRYBHTBqAJLVg1pmf9QGl_AArexQ/exec'; 

        function closeInfoModal() {
            document.getElementById('infoModal').classList.remove('show');
            // Simpan timestamp di session agar pop-up tidak muncul lagi saat refresh
            sessionStorage.setItem('lastViewedAnnouncementTime', new Date().toISOString());
        }

        // =========================================================================
        // FUNGSI KRITIS: FORMAT TANGGAL DI SISI BROWSER (CLIENT-SIDE) - FINAL FIX
        // =========================================================================
        function formatTanggalID(rawDateString) {
            if (!rawDateString || rawDateString === '-') return '-';
            
            const dateObj = new Date(rawDateString);
            if (isNaN(dateObj.getTime())) {
                return rawDateString; 
            }

            const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const timeOptions = { hour: '2-digit', minute: '2-digit', second: '2-digit', timeZoneName: 'short' };
            
            const formattedDate = dateObj.toLocaleDateString('id-ID', dateOptions);

            const hours = dateObj.getHours();
            const minutes = dateObj.getMinutes();
            const seconds = dateObj.getSeconds();
            
            // Cek apakah data string mengandung T atau : (tanda ada waktu)
            const hasTimeDataInString = String(rawDateString).includes(':') || String(rawDateString).includes('T');
            
            // Tampilkan waktu hanya jika ada data waktu DAN waktu BUKAN 00:00:00 (untuk Tanggal Kegiatan)
            if (hasTimeDataInString && (hours !== 0 || minutes !== 0 || seconds !== 0)) {
                const formattedTime = dateObj.toLocaleTimeString('id-ID', timeOptions);
                return `${formattedDate}, ${formattedTime}`;
            }
            
            // Hanya tampilkan tanggal (untuk Tanggal Kegiatan)
            return formattedDate;
        }


        document.addEventListener('DOMContentLoaded', function() {
            // Cek apakah pop-up sudah dilihat di sesi ini
            if (sessionStorage.getItem('lastViewedAnnouncementTime')) {
                console.log('Pop-up sudah dilihat di sesi ini. Tidak menampilkan.');
                return;
            }

            // 1. Ambil data pengumuman terbaru dari Apps Script (GET)
            // Menggunakan '?action=getLatestAnnouncement' untuk Apps Script yang sudah diupgrade
            fetch(APPS_SCRIPT_URL + '?action=getLatestAnnouncement') 
                .then(response => {
                    if (!response.ok) {
                          throw new Error('Network response was not ok: ' + response.statusText);
                    }
                    return response.json();
                })
                .then(result => {
                    if (result.status === 'success' && result.data && result.data.judul) {
                        const data = result.data;
                        
                        // 2. Isi data ke elemen-elemen di Modal dan FORMAT TANGGAL
                        document.getElementById('modalJudul').textContent = data.judul || 'Penting!';
                        
                        // === PENGGUNAAN FUNGSI FORMAT TANGGAL KRUSIAL DI SINI ===
                        document.getElementById('modalTanggal').textContent = formatTanggalID(data.tanggal) || '-';
                        document.getElementById('modalTimestamp').textContent = formatTanggalID(data.timestamp) || 'Tidak Diketahui';
                        // ========================================================
                        
                        document.getElementById('modalKategori').textContent = data.kategori || '-';
                        document.getElementById('modalPenanggungJawab').textContent = data.penanggungJawab || '-';
                        document.getElementById('modalKonten').textContent = data.konten || 'Tidak ada isi pengumuman.'; 

                        // 3. Tampilkan Modal setelah 1 detik
                        setTimeout(() => {
                            document.getElementById('infoModal').classList.add('show');
                        }, 1000); 

                    } else {
                        console.log('Tidak ada pengumuman terbaru atau data tidak valid. Pop-up tidak ditampilkan.');
                    }
                })
                .catch(error => {
                    console.error('Gagal mengambil pengumuman dari Apps Script:', error);
                    // alert('Kesalahan jaringan saat memuat informasi terbaru. Silakan coba lagi.');
                });
        });
    </script>
</body>
</html>
