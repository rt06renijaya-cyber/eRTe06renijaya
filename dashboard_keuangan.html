<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Dashboard Keuangan RT. 06 Reni Jaya</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap" rel="stylesheet">

<script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>

<style>
    /* ============================
        GLOBAL VAR & BASE STYLING
        ============================ */
    :root{
        --primary-deep: #004d40; /* Teal Dark */
        --primary-light: #005c5c; 
        --success: #28a745; /* Hijau Sukses */
        --error: #dc3545; /* Merah Error */
        --loading: #ffc107; /* Kuning (untuk Pengeluaran/Accent) */
        --bg: #f8fafc; /* Background sangat terang */
        --card: #ffffff;
        --text-color: #343a40;
        --muted-color: #6c757d;
    }
    
    * { box-sizing: border-box; }
    body {
        margin: 0;
        font-family: "Poppins", sans-serif;
        background: var(--bg);
        color: var(--text-color);
        -webkit-font-smoothing: antialiased;
        overflow-x: hidden;
    }
    
    /* MODIFIKASI: Margin negatif disesuaikan agar tidak terlalu besar di HP */
    .wrap {
        max-width: 1200px;
        margin: -60px auto 60px auto; /* Default untuk Desktop */
        padding: 0 20px;
        position: relative;
        z-index: 10;
    }

    /* ============================
        HEADER ELEGAN (PORTAL STYLE)
        ============================ */
    .header-elegant {
        background: linear-gradient(135deg, #003636, #005c5c); 
        color: white;
        padding: 90px 20px 120px 20px;
        border-bottom-left-radius: 60px;
        border-bottom-right-radius: 60px;
        position: relative;
        overflow: hidden;
        box-shadow: 0 10px 30px rgba(0,0,0,0.4); 
    }
    .header-elegant::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="p" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 0 0 L 10 10 M 10 0 L 0 10" stroke="rgba(255,255,255,0.08)" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23p)"/></svg>') repeat;
        opacity: 0.2;
        z-index: 1;
    }
    .header-content {
        position: relative;
        z-index: 3;
        text-align: center;
    }
    .title-elegant {
        font-size: 2.8em;
        font-weight: 700;
        margin: 0;
        letter-spacing: 1.5px;
        text-shadow: 0 2px 4px rgba(0,0,0,0.3);
    }
    .slogan-elegant {
        margin-top: 15px;
        font-size: 1.1em;
        opacity: 0.85;
        font-weight: 300;
        max-width: 800px;
        margin-left: auto;
        margin-right: auto;
    }
    
    /* STYLE DROPDOWN BARU */
    .form-select {
        padding: 8px 15px;
        border-radius: 8px;
        border: 1px solid rgba(255, 255, 255, 0.4);
        background-color: rgba(255, 255, 255, 0.1);
        color: white;
        font-size: 1.1em;
        font-weight: 600;
        margin-top: 15px;
        cursor: pointer;
        appearance: none; 
        background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="white" class="bi bi-caret-down-fill" viewBox="0 0 16 16"><path d="M7.247 11.14 2.451 5.658h9.596L7.247 11.14z"/></svg>');
        background-repeat: no-repeat;
        background-position: right 10px center;
        padding-right: 30px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }

    .form-select option {
        color: var(--text-color); 
        background: white;
    }

    /* ============================
        CARD & GRID STYLING
        ============================ */
    .card{
        background:var(--card);
        padding:24px;
        border-radius:12px;
        box-shadow:0 4px 15px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
        text-align: left;
    }
    .card h2 {
        font-size: 1.6em;
        font-weight: 700;
        color: var(--primary-deep);
        margin-top: 0;
        margin-bottom: 15px;
        border-bottom: 2px solid #f1f5f9;
        padding-bottom: 10px;
    }

    /* Tambahan: Styling untuk Canvas/Grafik */
    .card canvas {
        background: var(--card);
        padding: 10px 0 0 0; 
        border-radius: 8px;
    }

    /* Summary Cards */
    /* MODIFIKASI: Grid 2 kolom di HP, 4 kolom di desktop */
    .summary-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); /* Min 150px untuk HP */
        gap: 20px;
        margin-bottom: 30px;
    }
    @media (min-width: 768px) {
        .summary-grid {
            grid-template-columns: repeat(auto-fit, minmax(230px, 1fr)); /* 4 kolom di Desktop */
        }
    }
    
    .summary-card {
        padding: 25px;
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        transition: transform 0.3s ease;
        text-align: left;
    }
    .summary-card:hover {
        transform: translateY(-5px);
    }
    .summary-card .icon {
        font-size: 24px;
        margin-bottom: 10px;
        display: block;
    }
    .summary-card h3 {
        margin: 0 0 5px 0;
        font-size: 14px;
        color: var(--muted-color);
        font-weight: 600;
        text-transform: uppercase;
    }
    .summary-card .value {
        font-size: 24px; /* Sedikit dikecilkan untuk HP */
        font-weight: 800;
        margin-top: 5px;
    }
    @media (min-width: 768px) {
        .summary-card .value {
            font-size: 28px;
        }
    }

    /* Warna Kartu Disesuaikan dengan Palet Baru */
    .card-primary { background: #e0f2f1; color: var(--primary-deep); border-left: 5px solid var(--primary-deep); }
    .card-success { background: #e6ffed; color: var(--success); border-left: 5px solid var(--success); }
    .card-accent { background: #fff8e6; color: var(--loading); border-left: 5px solid var(--loading); } 
    .card-neutral { background: #f0f4f8; color: var(--text-color); border-left: 5px solid var(--primary-light); }
    
    /* Layout Utama */
    .dashboard-layout {
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 20px;
    }
    
    /* Tabel Transaksi */
    .transaction-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 15px;
        min-width: 500px; /* Minimal lebar tabel untuk mencegah terlalu padat */
    }
    /* MODIFIKASI: Mengatur font yang lebih kecil pada tabel di HP */
    .transaction-table th, .transaction-table td {
        padding: 10px 12px;
        text-align: left;
        font-size: 13px; /* Dikecilkan untuk HP */
    }
    @media (min-width: 768px) {
        .transaction-table th, .transaction-table td {
            padding: 12px 15px;
            font-size: 14px;
        }
    }
    
    .transaction-table th {
        background-color: #f1f5f9;
        color: var(--text-color);
        font-weight: 700;
        text-transform: uppercase;
        border-bottom: 2px solid #e2e8f0;
    }
    .transaction-table td {
        border-bottom: 1px solid #e2e8f0;
    }
    .transaction-table tr:hover {
        background-color: #fcfcfd;
    }
    
    .inflow { color: var(--success); font-weight: 600; }
    .outflow { color: var(--error); font-weight: 600; } 
    
    /* Ringkasan Kategori */
    .category-summary {
        list-style: none;
        padding: 0;
        margin: 0;
    }
    .category-item {
        display: flex;
        justify-content: space-between;
        padding: 12px 0;
        border-bottom: 1px solid #e2e8f0;
        font-size: 14px;
    }
    .category-item:last-child { border-bottom: none; }
    .category-item span:first-child { font-weight: 600; }

    /* Footer Sesuai Admin */
    .footer {
        background: linear-gradient(135deg, #002e28, #004d40);
        color: #e0ffff;
        text-align: center;
        padding: 30px 15px;
        margin-top: 40px;
        border-top-left-radius: 30px;
        border-top-right-radius: 30px;
    }
    .footer p { margin: 5px 0; font-size: 0.9em; }

    /* Tombol Kembali */
    .btn-back {
        display: inline-block;
        color: var(--primary-deep);
        text-decoration: none;
        font-weight: 600;
        padding: 10px 15px;
        border: 1px solid #e2e8f0;
        border-radius: 8px;
        transition: background-color 0.3s;
    }
    .btn-back:hover {
        background-color: #f1f5f9;
    }


    /* ============================
       RESPONSIVITAS UTAMA (MOBILE FIRST)
       ============================ */
    @media (max-width: 900px) {
        /* Perubahan layout utama: Main content dan sidebar menjadi satu kolom */
        .dashboard-layout {
            grid-template-columns: 1fr;
        }
        
        /* Mengurangi margin negatif di HP agar wrap tidak terlalu masuk ke header */
        .wrap {
            margin-top: -40px; 
            padding: 0 15px; /* Mengurangi padding di sisi */
        }
    }
    
    @media (max-width: 768px) {
        .title-elegant {
            font-size: 2em; /* Mengecilkan Judul */
        }
        .slogan-elegant {
            font-size: 0.9em; /* Mengecilkan Slogan */
        }
        
        /* Tambahan: Mengatur padding header agar tidak terlalu tinggi di HP */
        .header-elegant {
            padding: 50px 20px 80px 20px;
            border-bottom-left-radius: 40px;
            border-bottom-right-radius: 40px;
        }
    }
    
    @media (max-width: 500px) {
        /* Menghilangkan beberapa kolom pada tabel di layar sangat kecil */
        .transaction-table th:nth-child(2), 
        .transaction-table td:nth-child(2) { /* Kolom Kategori */
            display: none;
        }
        .transaction-table th:nth-child(5), 
        .transaction-table td:nth-child(5) { /* Kolom Jenis */
            display: none;
        }
        
        /* Mengatur agar tabel tetap terlihat rapi di layar kecil */
        .transaction-table {
            min-width: unset;
        }
    }
</style>
</head>
<body>

<div class="header-elegant">
    <div class="header-content">
        <h1 class="title-elegant"><i class="fas fa-hand-holding-usd"></i> Transparansi Keuangan RT. 06</h1>
        <p class="slogan-elegant">
            Laporan aliran kas, pemasukan, dan pengeluaran iuran RT bulan <span id="currentMonthYear">Memuat...</span> secara *real-time*.
        </p>
        
        <select id="periodSelector" class="form-select">
            <option value="">Memuat periode...</option>
        </select>
        
    </div>
</div>

<div class="wrap">
    
    <div class="summary-grid">
        <div class="summary-card card-primary">
            <h3><i class="fas fa-wallet icon"></i> Saldo Kas Saat Ini</h3>
            <div class="value" id="saldoSaatIni">Memuat...</div>
            <span>Status: <span id="statusSaldo">Memuat...</span></span>
        </div>
        
        <div class="summary-card card-success">
            <h3><i class="fas fa-arrow-alt-circle-up icon"></i> Pemasukan Bulan Ini</h3>
            <div class="value" id="totalPemasukan">Memuat...</div>
            <span><span id="pemasukanCount">0</span> Transaksi</span>
        </div>
        
        <div class="summary-card card-accent">
            <h3><i class="fas fa-arrow-alt-circle-down icon"></i> Pengeluaran Bulan Ini</h3>
            <div class="value" id="totalPengeluaran">Memuat...</div>
            <span><span id="pengeluaranCount">0</span> Transaksi</span>
        </div>

        <div class="summary-card card-neutral">
            <h3><i class="fas fa-calendar-alt icon"></i> Saldo Awal Bulan</h3>
            <div class="value" id="saldoBulanLalu">Memuat...</div>
            <span>Diambil dari data bulan sebelumnya</span>
        </div>
    </div>
    
    <div class="dashboard-layout">
        <div class="main-content">
            <div class="card">
                <h2><i class="fas fa-chart-bar"></i> Perbandingan Aliran Kas</h2>
                <p>Perbandingan Total Pemasukan dan Pengeluaran Bulan Ini (<span id="currentMonthShort"></span>) vs. Bulan Lalu (<span id="prevMonthShort"></span>).</p>
                <canvas id="flowChart" height="100"></canvas>
            </div>
            
            <div class="card">
                <h2><i class="fas fa-exchange-alt"></i> 10 Transaksi Terakhir</h2>
                <div style="overflow-x: auto;"> <table class="transaction-table">
                        <thead>
                            <tr>
                                <th>Tanggal</th>
                                <th>Kategori</th>
                                <th>Keterangan</th>
                                <th>Nominal</th>
                                <th>Jenis</th>
                            </tr>
                        </thead>
                        <tbody id="lastTransactionsBody">
                            <tr><td colspan="5" style="text-align:center; color: var(--muted-color);">Memuat data transaksi...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <div class="sidebar">
            <div class="card">
                <h2><i class="fas fa-arrow-alt-circle-up"></i> Pemasukan per Kategori</h2>
                <p style="font-size: 0.9em; color: var(--muted-color); margin-top: -10px;">Total Pemasukan berdasarkan Kategori bulan ini.</p>
                <ul class="category-summary" id="inflowCategoryList">
                    <li style="text-align:center; padding: 10px; color: var(--muted-color);">Memuat data...</li>
                </ul>
            </div>
            
            <div class="card">
                <h2><i class="fas fa-arrow-alt-circle-down"></i> Pengeluaran per Kategori</h2>
                <p style="font-size: 0.9em; color: var(--muted-color); margin-top: -10px;">Total Pengeluaran berdasarkan Kategori bulan ini.</p>
                <ul class="category-summary" id="outflowCategoryList">
                    <li style="text-align:center; padding: 10px; color: var(--muted-color);">Memuat data...</li>
                </ul>
            </div>
        </div>
    </div>
    
    <div style="margin-top: 40px; text-align: center;">
        <a href="index.html" class="btn-back"><i class="fas fa-arrow-left"></i> Kembali ke Portal Utama</a>
    </div>

</div>

<div class="footer">
    <p>Portal Warga RT. 06 Reni Jaya</p>
    <p>&copy; 2025 Hak Cipta Dilindungi.<br>Dikelola oleh Pengurus RT. 06</p>
</div>

<script>
// ===============================================
// ⚠️ GANTI URL INI dengan URL DEPLOYMENT APPS SCRIPT Anda yang baru
// ===============================================
const ENDPOINT_APPS_SCRIPT = "https://script.google.com/macros/s/AKfycbw6e8cX1sLWWYrIp2FLx5hP5WhhQGky65FpDcVa7b7teVZUql_ujY5SgHux3EGwAwCU-w/exec"; 

const monthNames = ["Januari", "Februari", "Maret", "April", "Mei", "Juni", "Juli", "Agustus", "September", "Oktober", "November", "Desember"];
let flowChartInstance = null;

/**
 * Helper: Format Angka ke Rupiah
 */
function formatRupiah(number) {
    if (number === undefined || number === null) return 'Rp 0';
    return 'Rp ' + Math.round(number).toLocaleString('id-ID');
}

/**
 * Helper: Mengambil daftar bulan yang tersedia dari Apps Script
 */
async function populatePeriodSelector() {
    const select = document.getElementById('periodSelector');
    
    try {
        const response = await fetch(`${ENDPOINT_APPS_SCRIPT}?action=getAvailablePeriods`);
        const data = await response.json();

        if (data.status === 'success' && data.periods && data.periods.length > 0) {
            select.innerHTML = '';
            
            data.periods.forEach(period => {
                const [year, month] = period.split('-');
                const monthName = monthNames[parseInt(month) - 1]; 
                
                const option = document.createElement('option');
                option.value = period; // Format: YYYY-MM
                option.textContent = `${monthName} ${year}`;
                
                // Set default option ke periode terbaru (yang pertama di array)
                if (period === data.periods[0]) {
                    option.selected = true;
                }
                
                select.appendChild(option);
            });

            // Setelah dropdown terisi, pasang event listener dan muat data pertama kali
            select.addEventListener('change', (e) => {
                const [year, month] = e.target.value.split('-');
                fetchDashboardData(month, year);
            });

            // Muat data untuk bulan yang terpilih (bulan terbaru)
            const [defaultYear, defaultMonth] = data.periods[0].split('-');
            fetchDashboardData(defaultMonth, defaultYear);
            
        } else {
            select.innerHTML = '<option value="">Tidak ada data histori</option>';
            fetchDashboardData(null, null); // Coba muat bulan ini sebagai fallback
        }

    } catch (error) {
        console.error('Error fetching available periods:', error);
        select.innerHTML = '<option value="">Gagal memuat periode</option>';
        fetchDashboardData(null, null); // Coba muat bulan ini sebagai fallback
    }
}


/**
 * Main function: Mengambil semua data dashboard
 */
async function fetchDashboardData(month = null, year = null) {
    let url = `${ENDPOINT_APPS_SCRIPT}?action=getDashboard`;
    
    // Tambahkan parameter jika ada
    if (month && year) {
        url += `&month=${month}&year=${year}`;
    }
    
    // Tampilkan status loading di kartu utama
    document.getElementById('saldoSaatIni').textContent = 'Memuat...';

    try {
        const response = await fetch(url);
        
        if (!response.ok) { throw new Error(`HTTP error! status: ${response.status}`); }
        
        const text = await response.text();
        const data = JSON.parse(text);

        if (data.status === 'success') {
            
            // Perbarui label bulan berdasarkan data yang dikembalikan Apps Script
            const targetMonthName = data.periodInfo.monthName;
            const targetYear = data.periodInfo.year;
            
            // Tentukan label bulan lalu (diperlukan untuk chart)
            const targetDate = new Date(targetYear, data.periodInfo.month - 1, 1);
            const prevMonthDate = new Date(targetDate.getFullYear(), targetDate.getMonth() - 1, 1);
            const prevMonthShort = monthNames[prevMonthDate.getMonth()];
            
            document.getElementById('currentMonthYear').textContent = `${targetMonthName} ${targetYear}`;
            document.getElementById('currentMonthShort').textContent = targetMonthName;
            document.getElementById('prevMonthShort').textContent = prevMonthShort;

            // Update komponen lainnya
            updateSummaryCards(data.summary);
            updateTransactionTable(data.lastTransactions);
            updateCategoryBreakdown(data.categoryBreakdown);
            updateChartComparison(data.monthlyComparison, targetMonthName, prevMonthShort);
        } else {
            console.error("Gagal memuat data dashboard:", data.message);
            document.getElementById('saldoSaatIni').textContent = `ERROR: ${data.message.substring(0, 30)}...`;
        }

    } catch (error) {
        console.error('Error fetching dashboard data:', error);
        document.getElementById('saldoSaatIni').textContent = `Gagal Koneksi: ${error.message}`;
    }
}

/**
 * Memperbarui kartu ringkasan
 */
function updateSummaryCards(summary) {
    document.getElementById('saldoSaatIni').textContent = formatRupiah(summary.currentBalance);
    document.getElementById('totalPemasukan').textContent = formatRupiah(summary.totalInflow);
    document.getElementById('pemasukanCount').textContent = summary.inflowCount || 0;
    document.getElementById('totalPengeluaran').textContent = formatRupiah(summary.totalOutflow);
    document.getElementById('pengeluaranCount').textContent = summary.outflowCount || 0;
    document.getElementById('saldoBulanLalu').textContent = formatRupiah(summary.previousMonthBalance);
    
    const statusSaldoElement = document.getElementById('statusSaldo');
    if (summary.currentBalance < 1000000) { 
        statusSaldoElement.textContent = 'Perlu Prioritas Kas';
        statusSaldoElement.style.color = 'var(--error)';
    } else {
        statusSaldoElement.textContent = 'Baik';
        statusSaldoElement.style.color = 'var(--success)';
    }
}

/**
 * Memperbarui tabel transaksi terakhir
 */
function updateTransactionTable(transactions) {
    const tbody = document.getElementById('lastTransactionsBody');
    tbody.innerHTML = '';
    
    if (transactions && transactions.length > 0) {
        transactions.forEach(tx => {
            const row = tbody.insertRow();
            const nominalFormatted = formatRupiah(tx.nominal);
            const nominalClass = tx.type === 'Pemasukan' || tx.type === 'Saldo Awal' ? 'inflow' : 'outflow';
            
            row.innerHTML = `
                <td>${tx.tanggal}</td>
                <td>${tx.kategori}</td>
                <td>${tx.keterangan}</td>
                <td class="${nominalClass}">${nominalFormatted}</td>
                <td><span class="${nominalClass}">${tx.type}</span></td>
            `;
        });
    } else {
        const row = tbody.insertRow();
        row.innerHTML = `<td colspan="5" style="text-align:center; color: var(--muted-color);">Belum ada transaksi di bulan yang dipilih.</td>`;
    }
}

/**
 * Memperbarui ringkasan kategori (Pemasukan & Pengeluaran)
 */
function updateCategoryBreakdown(data) {
    // 1. Pemasukan
    const inflowUl = document.getElementById('inflowCategoryList');
    inflowUl.innerHTML = '';
    
    if (data.inflow && data.inflow.length > 0) {
        data.inflow.forEach(item => {
            const li = document.createElement('li');
            li.className = 'category-item';
            li.innerHTML = `
                <span>${item.kategori}</span>
                <span class="inflow">${formatRupiah(item.total)}</span>
            `;
            inflowUl.appendChild(li);
        });
    } else {
        inflowUl.innerHTML = `<li style="text-align:center; padding: 10px; color: var(--muted-color);">Belum ada pemasukan di bulan ini.</li>`;
    }
    
    // 2. Pengeluaran
    const outflowUl = document.getElementById('outflowCategoryList');
    outflowUl.innerHTML = '';

    if (data.outflow && data.outflow.length > 0) {
        data.outflow.forEach(item => {
            const li = document.createElement('li');
            li.className = 'category-item';
            li.innerHTML = `
                <span>${item.kategori}</span>
                <span class="outflow">${formatRupiah(item.total)}</span>
            `;
            outflowUl.appendChild(li);
        });
    } else {
        outflowUl.innerHTML = `<li style="text-align:center; padding: 10px; color: var(--muted-color);">Belum ada pengeluaran di bulan ini.</li>`;
    }
}


/**
 * Inisialisasi dan Update Chart (Perbandingan Bulanan)
 */
function updateChartComparison(data, currentMonthName, prevMonthName) {
    const ctx = document.getElementById('flowChart').getContext('2d');
    
    if (flowChartInstance) {
        flowChartInstance.destroy(); 
    }

    const labels = data.labels;

    flowChartInstance = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: labels,
            datasets: [
                {
                    label: `Bulan Ini (${currentMonthName})`,
                    data: data.current,
                    // WARNA BARU
                    backgroundColor: ['var(--success)', 'var(--loading)'],
                    borderColor: 'white',
                    borderWidth: 1,
                    borderRadius: 6, // Sudut membulat
                    barPercentage: 0.8,
                    categoryPercentage: 0.8
                },
                {
                    label: `Bulan Lalu (${prevMonthName})`,
                    data: data.previous,
                    // WARNA BARU (Transparan)
                    backgroundColor: ['#b3e6c0', '#ffe9b3'], 
                    borderColor: 'white',
                    borderWidth: 1,
                    borderRadius: 6,
                    barPercentage: 0.8,
                    categoryPercentage: 0.8
                }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false, 
            aspectRatio: 1.5, // Rasio 3:2 (Lebar:Tinggi) untuk desktop
            
            plugins: {
                legend: { 
                    position: 'top', 
                    labels: {
                        padding: 20,
                        font: {
                            family: 'Poppins',
                            weight: 600
                        }
                    }
                },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            let label = context.dataset.label || '';
                            if (label) {
                                label += ': ';
                            }
                            // Memformat nilai Rupiah di Tooltip
                            if (context.parsed.y !== null) {
                                label += formatRupiah(context.parsed.y);
                            }
                            return label;
                        }
                    },
                    backgroundColor: 'rgba(0, 0, 0, 0.8)',
                    titleFont: { size: 14, weight: '700' },
                    bodyFont: { size: 13 }
                }
            },
            scales: {
                x: {
                    grid: {
                        display: false // Hilangkan garis grid vertikal
                    },
                    ticks: {
                        font: {
                            weight: '600'
                        }
                    }
                },
                y: {
                    beginAtZero: true,
                    title: { 
                        display: true, 
                        text: 'Nominal (Rp)',
                        font: { weight: '600' }
                    },
                    grid: {
                        color: 'rgba(0, 0, 0, 0.08)',
                        borderDash: [5, 5] // Garis putus-putus
                    },
                    ticks: {
                        callback: function(value) {
                            // Format sumbu Y agar lebih mudah dibaca (Jt atau K)
                            if (value >= 1000000) return (value / 1000000) + ' Jt';
                            if (value >= 1000) return (value / 1000) + ' K';
                            return value;
                        }
                    }
                }
            }
        }
    });
}

// Jalankan saat dokumen selesai dimuat
document.addEventListener('DOMContentLoaded', () => {
    populatePeriodSelector(); 
});
</script>
</body>
</html>
